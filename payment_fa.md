
![Zarinplus Logo](https://www.zarinplus.com/wp-content/uploads/2024/02/Logo-1.png)

# مستندات زرین‌پلاس

لطفاً این مستند را برای درک نحوه پیاده‌سازی پرداخت از طریق نقطه پایان درخواست مطالعه کنید.

## فهرست مطالب

* [پرداخت](#پرداخت)
	* [ایجاد درخواست پرداخت](#ایجاد-درخواست-پرداخت)
	* [لغو تراکنش](#لغو-تراکنش)
	* [تأیید تراکنش](#تأیید-تراکنش)
	* [بازگشت تراکنش](#بازگشت-تراکنش)
	* [لیست کدهای وضعیت](#لیست-کدهای-وضعیت)
	* [افزونه ووکامرس](#افزونه-ووکامرس)

---

## پرداخت

### ایجاد درخواست پرداخت

برای ایجاد یک تراکنش درخواست، فروشنده باید از API‌های ارائه‌شده استفاده کند.

#### نقطه پایان درخواست

```
https://api.zarinplus.com/payment/request
```

#### پارامترهای ارسالی

با استفاده از روش `POST`، پارامترهای زیر را به نقطه پایان ارسال کنید:

```json
{
    "amount" : 50000,
    "cancel" : "http://www.mystore.com/cancel/",
    "success" : "http://www.mystore.com/success/",
    "item" : "5000 Toman Voucher",
    "cellphone" : "09121111111",
    "email" : "yourname@domain.com",
    "token" : "9a1bfc8895cc5df72715fe81f6ac121936d00b61"
}
```

#### توضیحات پارامترها

هر یک از پارامترهای ارسالی شامل نوع و توضیحات مربوطه می‌باشد:

- `amount`: مقدار پرداخت به صورت عدد صحیح.
- `cancel`: آدرس URL برای لغو تراکنش.
- `success`: آدرس URL برای موفقیت تراکنش.
- `item`: توضیحاتی در مورد تراکنش.
- `cellphone`: شماره تلفن همراه خریدار.
- `email`: آدرس ایمیل خریدار.
- `token`: توکن فروشنده که ضروری است.

#### پاسخ موفق

در صورت ارسال درخواست صحیح، پاسخ مشابه زیر خواهد بود:

```json
{
    "status" : "200",
    "message" : "Get the authority code",
    "authority" : "f72705fe8a9bfc8895cc5dac121931f696d00b61",
    "redirect_url" : "https://pwa.zarinplus.com/authority=f72705fe8a9bfc8895cc5dac121931f696d00b61&phone=09121111111"
}
```

### هدایت کاربر به لینک پرداخت
پس از دریافت `authority`، برای پردازش و پرداخت، کاربر باید به لینک `redirect_url` هدایت شود.

---

### لغو تراکنش

کاربران می‌توانند تراکنش را لغو کنند و باید تأییدیه لغو در برنامه ارسال شود.

#### نقطه پایان لغو

```
https://api.zarinplus.com/payment/cancel
```

#### پارامترهای ارسالی

پارامترهای `authority` را به نقطه پایان ارسال کنید:

```json
{
    "authority" : "f72715fe8a1bfc8895cc5dac121931f696d00b61"
}
```

#### توضیحات پارامترها

- `authority`: کد مجوز که از درخواست پرداخت دریافت شده است.

#### پاسخ موفق

در صورت موفقیت لغو تراکنش، پاسخ مشابه زیر خواهد بود:

```json
{
    "status": 200,
    "message": "You have canceled merchant"
}
```

---

### تأیید تراکنش

فروشنده باید پس از تأیید تراکنش توسط کاربر، آن را تأیید کند.

#### نقطه پایان تأیید

```
https://api.zarinplus.com/payment/verify
```

#### پارامترهای ارسالی

```json
{
    "authority" : "f72715fe81f69a1bfc8895cc5dac121936d00b61",
    "token" : "9a1bfc8895cc5df72715fe81f6ac121936d00b61",
    "amount": 50000
}
```

#### توضیحات پارامترها

- `authority`: کد مجوز که از درخواست پرداخت دریافت شده است.
- `token`: توکن فروشنده که ضروری است.

#### پاسخ موفق

در صورت موفقیت تراکنش، پاسخ مشابه زیر خواهد بود:

```json
{
    "status" : "200",
    "message" : "Successful",
    "reference" : "46a1e78525619a25b368c32b9ba11b92f6063e0c"
}
```

---

### بازگشت تراکنش

شما می‌توانید هر تراکنش موفق را برگردانید.

#### نقطه پایان بازگشت

```
https://api.zarinplus.com/payment/reverse
```

#### پارامترهای ارسالی

```json
{
    "reference" : "46a1e78525619a25b368c32b9ba11b92f6063e0c",
    "authority" : "f72715fe8a1bfc8895cc5dac121931f696d00b61",
    "token" : "9a1bfc8895cc5df72715fe81f6ac121936d00b61"
}
```

#### توضیحات پارامترها

- `reference`: مرجع تراکنش که در زمان تأیید دریافت شده است.
- `authority`: کد مجوز که از درخواست پرداخت دریافت شده است.
- `token`: توکن فروشنده که ضروری است.

#### پاسخ موفق

در صورت موفقیت تراکنش بازگشتی، پاسخ مشابه زیر خواهد بود:

```json
{
    "status" : "500",
    "message" : "Reversed"
}
```

---

## لیست کدهای وضعیت

|  کد	    | پیام       |
| ------------- |:-------------:|
| 400 | کد مجوز نامعتبر |
| 401 | توکن نامعتبر | 
| 403 | درخواست غیرمجاز |

## افزونه ووکامرس
برای دریافت افروزنه قابل نصب در وردپرس  [اینجا](https://github.com/zarinplus/docs/blob/master/zarinplus-woocommerce-payment-gateway.zip) کلیک کنید.
